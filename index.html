<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>AscendX Academy • Courses</title>
<style>
:root{
  --navy:#0b2340; --teal:#2aa6a1; --gold:#cfa939;
  --muted:#6b7785; --bg:#f6f8fb; --card:#fff;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:Inter,Arial,sans-serif;
  background:var(--bg); color:var(--navy);
}
.wrap{max-width:1100px;margin:auto;padding:15px}
header{background:#fff;padding:10px;display:flex;align-items:center;gap:12px;border-bottom:1px solid #e6eef3}
.logo{width:44px;height:44px;background:linear-gradient(135deg,var(--navy),#123a57);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:800;border-radius:8px}
.title{font-size:20px;font-weight:700}
.subtitle{font-size:13px;color:var(--muted)}

.card{background:var(--card);padding:14px;border-radius:12px;margin-top:12px;border:1px solid rgba(11,35,64,0.07)}

h2{margin-top:0;margin-bottom:8px}

.module{border:1px solid #e6edf3;border-radius:10px;padding:12px;margin-bottom:10px;transition:transform .2s;}
.module:hover{transform:scale(1.01);}
.lesson-list{margin-top:10px;display:none;opacity:0;transition:opacity .3s;}
.lesson{margin-top:8px;background:#f7fbfb;padding:8px;border-radius:8px;}

.badge-free{color:var(--teal);font-weight:700}
.badge-premium{color:var(--gold);font-weight:700}

.btn{padding:6px 10px;border-radius:8px;cursor:pointer;border:0}
.btn.primary{background:var(--navy);color:#fff}
.btn.secondary{background:#fff;border:1px solid var(--navy);color:var(--navy)}

.video-wrap{position:relative;padding-top:56%;margin-top:10px;border-radius:8px;overflow:hidden}
.video-wrap iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}

textarea{width:100%;height:120px;border:1px solid #e6edf3;border-radius:8px;padding:8px;margin-top:8px;font-family:monospace;}
.preview{height:220px;border:1px solid #e6edf3;border-radius:8px;margin-top:8px;overflow:hidden}
</style>
</head>
<body>

<div class="wrap">

<header>
  <div class="logo">AX</div>
  <div>
    <div class="title">AscendX Academy</div>
    <div class="subtitle">Learn • Build • Grow</div>
  </div>
</header>

<div id="courses-container">Loading courses…</div>

<div class="card" style="margin-top:20px">
  <h2>About AscendX</h2>
  <p>AscendX Academy is a modern learning platform for courses, modules, and lessons — fully open and accessible.</p>
  <p>Developer: Ray Sage who's also known as Paul Zulu</p>
</div>

</div>

<script>
/* ==================
   GitHub API config
   ================== */
const USERNAME = "Ray-Sage";
const REPO     = "AscendX";
const FILE_PATH = "courses.json";

let DATA = {};

// Fetch JSON from GitHub api
async function fetchFromGitHub(){
  try{
    const response = await fetch(
      `https://api.github.com/repos/${USERNAME}/${REPO}/contents/${FILE_PATH}?t=${Date.now()}`,
      {cache:"no-store"}
    );
    if(!response.ok) throw new Error("Failed to fetch");
    const json = await response.json();
    const decoded = atob(json.content);
    DATA = JSON.parse(decoded);
  }catch(err){
    console.error("GitHub fetch error:",err);
    DATA = {courses:[]};
  }
  renderCourses();
}

// Render all courses + modules + lessons
function renderCourses(){
  const container = document.getElementById("courses-container");
  container.innerHTML="";

  (DATA.courses||[]).forEach((course,cIdx)=>{
    const courseCard = document.createElement("div");
    courseCard.className="card";

    courseCard.innerHTML = `
      <h2>${course.title}</h2>
      <div class="subtitle">${course.subtitle||""}</div>
      <div id="course-${cIdx}-modules"></div>
    `;

    container.appendChild(courseCard);

    renderModules(course.modules||[],cIdx);
  });
}

// Render modules for a specific course index
function renderModules(modules, courseIndex){
  const modulesContainer = document.getElementById(`course-${courseIndex}-modules`);
  modulesContainer.innerHTML="";

  modules.forEach((m,mIdx)=>{
    const div = document.createElement("div");
    div.className="module";

    const badge = m.free
      ? `<span class="badge-free">FREE</span>`
      : `<span class="badge-premium">PREMIUM</span>`;

    div.innerHTML = `
      <div>
        <strong>${m.title}</strong> ${badge}
      </div>
      <div>${m.desc||""}</div>
      <button class="btn primary" data-toggle="${courseIndex}-${mIdx}">Show Lessons</button>
      <div class="lesson-list" id="mod-${courseIndex}-${mIdx}-lessons"></div>
    `;
    modulesContainer.appendChild(div);

    renderLessons(m.lessons||[],courseIndex,mIdx);
  });
}

function renderLessons(lessons, cIdx, mIdx){
  const lessonList = document.getElementById(`mod-${cIdx}-${mIdx}-lessons`);
  lessonList.innerHTML="";

  lessons.forEach((les,lIdx)=>{
    const lv = document.createElement("div");
    lv.className="lesson";
    lv.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><strong>${les.title}</strong><div>${les.text||""}</div></div>
        <div style="display:flex;flex-direction:column;gap:6px">
          ${les.video?`<button class="btn secondary" data-play="${cIdx}-${mIdx}-${lIdx}">Play</button>`:""}
        </div>
      </div>
    `;
    lessonList.appendChild(lv);
  });
}

// Global click listener for toggle + play
document.addEventListener("click",(e)=>{
  // Toggle lesson list
  if(e.target.dataset.toggle){
    const [cIdx,mIdx] = e.target.dataset.toggle.split("-");
    const el = document.getElementById(`mod-${cIdx}-${mIdx}-lessons`);
    el.style.display = el.style.display==="block"?"none":"block";
  }

  // Play video
  if(e.target.dataset.play){
    const [cIdx,mIdx,lIdx] = e.target.dataset.play.split("-");
    const les = DATA.courses[cIdx].modules[mIdx].lessons[lIdx];
    document.getElementById("current-lesson-title").innerText = les.title;

    if(les.video){
      const videoWrap = document.getElementById("sidebar-video");
      document.getElementById("lesson-video").src = les.video;
      videoWrap.style.display="block";
    }
  }
});

// Initialize
fetchFromGitHub();
</script>

</body>
</html>
