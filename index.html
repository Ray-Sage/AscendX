<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AscendX Academy — Student View</title>
<style>
  :root{
    --navy:#0b2340; --teal:#2aa6a1; --gold:#cfa939; --muted:#6b7785;
    --bg:#f6f8fb; --card:#fff; --radius:12px; --maxw:1100px;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter, system-ui, Arial, sans-serif;background:var(--bg);color:var(--navy);-webkit-font-smoothing:antialiased;}
  .wrap{max-width:var(--maxw);margin:0 auto;padding:12px;}
  header{display:flex;align-items:center;gap:12px;background:#fff;padding:10px;border-bottom:1px solid #e6eef3;position:sticky;top:0;z-index:20}
  .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,var(--navy),#123a57);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800}
  .title{font-weight:700}
  .subtitle{font-size:13px;color:var(--muted)}
  .card{background:var(--card);border-radius:12px;padding:14px;margin-top:12px;border:1px solid rgba(11,35,64,0.04)}
  main{display:grid;grid-template-columns:1fr 360px;gap:16px;margin-top:16px}
  @media(max-width:900px){main{grid-template-columns:1fr}}
  .modules{display:grid;gap:10px}
  .module{padding:12px;border-radius:10px;border:1px solid #e6eef3;background:#fff;transition:transform 0.2s}
  .module:hover{transform:scale(1.01)}
  .module h3{margin:0 0 6px 0}
  .lesson-list{margin-top:8px;display:none;opacity:0;transition:opacity 0.3s}
  .lesson{padding:8px;border-radius:8px;background:#f7fbfb;margin-top:6px;transition:transform 0.2s}
  .lesson:hover{transform:scale(1.01)}
  .btn{padding:8px 10px;border-radius:8px;border:0;cursor:pointer}
  .btn.primary{background:var(--navy);color:#fff}
  .btn.secondary{background:#fff;border:1px solid var(--navy);color:var(--navy)}
  .muted{color:var(--muted)}
  .video-wrap{position:relative;padding-top:56%;border-radius:8px;overflow:hidden;margin-top:10px}
  .video-wrap iframe{position:absolute;left:0;top:0;width:100%;height:100%;border:0}
  textarea{width:100%;height:120px;border-radius:8px;border:1px solid #e6edf3;padding:8px;font-family:monospace}
  .preview{height:220px;border-radius:8px;border:1px solid #e6edf3;overflow:hidden;margin-top:8px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">AX</div>
      <div>
        <div class="title">AscendX Academy</div>
        <div class="subtitle">Learn • Progress • Excel</div>
      </div>
    </header>

    <!-- Student area -->
    <div id="student-area">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:700">Courses</div>
            <div class="small muted">Progress is saved locally.</div>
          </div>
        </div>
      </div>

      <main>
        <section>
          <div class="card">
            <h2>Modules</h2>
            <div id="modules-list" class="modules">Loading modules…</div>
          </div>
        </section>

        <aside class="rightcol">
          <div class="card">
            <div style="font-weight:700">Now Playing: <span id="current-lesson-title">—</span></div>
            <div class="video-wrap" id="video-container" style="display:none;">
              <iframe id="lesson-video" src="" title="Lesson video" allowfullscreen></iframe>
            </div>
          </div>

          <div class="card" style="margin-top:12px">
            <div style="font-weight:700">Code Playground</div>
            <textarea id="code-input">&lt;!doctype html&gt;
&lt;html&gt;&lt;body&gt;
&lt;h1&gt;Hello AscendX&lt;/h1&gt;
&lt;p&gt;Edit & press Run.&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;</textarea>
            <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
              <button id="run-btn" class="btn primary">Run</button>
              <button id="copy-btn" class="btn secondary">Copy</button>
              <button id="reset-code-btn" class="btn">Reset</button>
            </div>
            <div class="preview" style="margin-top:8px"><iframe id="code-output" sandbox="allow-scripts"></iframe></div>
          </div>
        </aside>
      </main>
    </div>
  </div>

<script>
const USERNAME = 'YOUR_GITHUB_USERNAME';
const REPO = 'ascendx';
const FILE_PATH = 'courses.json';

let COURSES = { modules: [] };

async function fetchCoursesFromGitHub(){
  try{
    const url = `https://raw.githubusercontent.com/${USERNAME}/${REPO}/main/${FILE_PATH}`;
    const r = await fetch(url, {cache:"no-store"});
    if(!r.ok) throw new Error('Failed to fetch: ' + r.status);
    COURSES = await r.json();
  }catch(err){
    console.warn('GitHub fetch failed, using local fallback', err);
    COURSES = {
      modules: [
        {id:'m1',title:'HTML Basics',desc:'Intro to HTML',free:true,lessons:[
          {title:'HTML Intro',video:'',text:'Welcome!'}
        ]}
      ]
    };
  }
  renderModules();
  wireStudentHandlers();
}

function renderModules(){
  const list = document.getElementById('modules-list');
  list.innerHTML = '';
  (COURSES.modules||[]).forEach((m,midx)=>{
    const card = document.createElement('div'); card.className='module';
    const freeText = m.free ? '<span style="color:var(--teal);font-weight:700">FREE</span>' : '<span style="color:var(--gold);font-weight:700">PREMIUM</span>';
    card.innerHTML = `<h3>${m.title} ${freeText}</h3>
      <div class="muted">${m.desc||''}</div>
      <div style="margin-top:8px"><button class="btn primary" data-action="toggle" data-idx="${midx}">Show / Hide Lessons</button></div>
      <div class="lesson-list" id="module-${midx}"></div>`;
    list.appendChild(card);

    const lessonList = card.querySelector('.lesson-list');
    (m.lessons||[]).forEach((les,lidx)=>{
      const lv = document.createElement('div'); lv.className='lesson';
      lv.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center">
        <div><strong>${les.title}</strong><div class="small muted">${les.text||''}</div></div>
        <div style="display:flex;flex-direction:column;gap:6px">
          <button class="btn secondary" data-action="play" data-mid="${midx}" data-lid="${lidx}">Play</button>
          ${m.free?'':'<button class="btn primary" data-action="unlock">Unlock</button>'}
        </div>
      </div>`;
      lessonList.appendChild(lv);
    });
  });
}

function wireStudentHandlers(){
  document.getElementById('modules-list').addEventListener('click', (e)=>{
    const btn = e.target.closest('button'); if(!btn) return;
    const action = btn.getAttribute('data-action');
    if(action==='toggle'){
      const idx = btn.getAttribute('data-idx');
      const el = document.getElementById('module-'+idx);
      if(el){
        el.style.display = (el.style.display==='block')?'none':'block';
        if(el.style.display==='block') el.style.opacity='1'; else el.style.opacity='0';
      }
    } else if(action==='play'){
      const mid = +btn.getAttribute('data-mid');
      const lid = +btn.getAttribute('data-lid');
      playLesson(mid,lid);
    } else if(action==='unlock'){
      window.alert('This is premium content. Unlock soon!');
    }
  });
}

function playLesson(mid,lid){
  const lesson = (COURSES.modules[mid].lessons||[])[lid];
  if(!lesson) return;
  document.getElementById('current-lesson-title').textContent = lesson.title;
  const videoWrap = document.getElementById('video-container');
  if(lesson.video){
    document.getElementById('lesson-video').src = lesson.video;
    videoWrap.style.display='block';
  } else {
    videoWrap.style.display='none';
  }
}

/* Code playground */
function wirePlayground(){
  const codeInput = document.getElementById('code-input');
  const codeOutput = document.getElementById('code-output');
  document.getElementById('run-btn').addEventListener('click', ()=>{
    const doc = codeOutput.contentDocument || codeOutput.contentWindow.document;
    doc.open(); doc.write(codeInput.value||'<h1>Hello AscendX</h1>'); doc.close();
  });
  document.getElementById('copy-btn').addEventListener('click', ()=>{
    navigator.clipboard.writeText(codeInput.value).then(()=>alert('Code copied!'));
  });
  document.getElementById('reset-code-btn').addEventListener('click', ()=>{
    codeInput.value='<!doctype html>\n<html>\n<body>\n<h1>Hello AscendX</h1>\n<p>Edit & press Run.</p>\n</body>\n</html>';
    document.getElementById('run-btn').click();
  });
}

/* Start */
window.addEventListener('load', async ()=>{
  await fetchCoursesFromGitHub();
  wirePlayground();
});
</script>
</body>
</html>
